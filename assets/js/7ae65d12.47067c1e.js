"use strict";(self.webpackChunkwriteups_docs=self.webpackChunkwriteups_docs||[]).push([[5703],{3905:(e,t,r)=>{r.d(t,{Zo:()=>l,kt:()=>m});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=n.createContext({}),i=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},l=function(e){var t=i(e.components);return n.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,l=f(e,["components","mdxType","originalType","parentName"]),p=i(r),u=a,m=p["".concat(c,".").concat(u)]||p[u]||d[u]||o;return r?n.createElement(m,s(s({ref:t},l),{},{components:r})):n.createElement(m,s({ref:t},l))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=r.length,s=new Array(o);s[0]=u;var f={};for(var c in t)hasOwnProperty.call(t,c)&&(f[c]=t[c]);f.originalType=e,f[p]="string"==typeof e?e:a,s[1]=f;for(var i=2;i<o;i++)s[i]=r[i];return n.createElement.apply(null,s)}return n.createElement.apply(null,r)}u.displayName="MDXCreateElement"},3473:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>p,frontMatter:()=>o,metadata:()=>f,toc:()=>i});var n=r(7462),a=(r(7294),r(3905));const o={},s="STINGS",f={unversionedId:"2021/IMAGINARYCTF/challenges/stings",id:"2021/IMAGINARYCTF/challenges/stings",title:"STINGS",description:"- File : stings",source:"@site/docs/2021/IMAGINARYCTF/challenges/stings.md",sourceDirName:"2021/IMAGINARYCTF/challenges",slug:"/2021/IMAGINARYCTF/challenges/stings",permalink:"/writeups-docs/docs/2021/IMAGINARYCTF/challenges/stings",draft:!1,editUrl:"https://github.com/pynard/writeups-docs/tree/main/docs/2021/IMAGINARYCTF/challenges/stings.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"STACKOVERFLOW",permalink:"/writeups-docs/docs/2021/IMAGINARYCTF/challenges/stackoverflow"},next:{title:"RARCTF",permalink:"/writeups-docs/docs/2021/RARCTF/"}},c={},i=[],l={toc:i};function p(e){let{components:t,...r}=e;return(0,a.kt)("wrapper",(0,n.Z)({},l,r,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"stings"},"STINGS"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"Description\nEnter the beehive. Don't get stung.\n\n(Note: the password/flag is in the format ictf{.*})\n\nAttachments\nhttps://2021.imaginaryctf.org/r/stings\n\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"File : ",(0,a.kt)("a",{parentName:"li",href:"../attachements/stings/stings"},"stings"))),(0,a.kt)("p",null,"Here we have to type the password that is the flag"),(0,a.kt)("p",null,"Looking in gdb we can see that the typed pwd is compared with an other string from which each is char is substracted by 1 :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\u2502       \u250c\u2500< 0x0000083c      eb47           jmp 0x885\n\u2502       \u2502   ; CODE XREF from main @ 0x88c\n\u2502      \u250c\u2500\u2500> 0x0000083e      8b85ecedffff   mov eax, dword [var_1214h]\n\u2502      \u254e\u2502   0x00000844      4898           cdqe\n\u2502      \u254e\u2502   0x00000846      0fb68405f0ed.  movzx eax, byte [rbp + rax - 0x1210]\n\u2502      \u254e\u2502   0x0000084e      0fbed0         movsx edx, al\n\u2502      \u254e\u2502   0x00000851      8b85ecedffff   mov eax, dword [var_1214h]\n\u2502      \u254e\u2502   0x00000857      4898           cdqe\n\u2502      \u254e\u2502   0x00000859      0fb68405f0ee.  movzx eax, byte [rbp + rax - 0x1110]\n\u2502      \u254e\u2502   0x00000861      0fbec0         movsx eax, al\n\u2502      \u254e\u2502   0x00000864      83e801         sub eax, 1\n\u2502      \u254e\u2502   0x00000867      39c2           cmp edx, eax\n\u2502     \u250c\u2500\u2500\u2500< 0x00000869      7413           je 0x87e\n\u2502     \u2502\u254e\u2502   0x0000086b      488d3d1e0100.  lea rdi, str.Im_disappointed._stings_you ; 0x990 ; "I\'m disappointed. *stings you*"\n\u2502     \u2502\u254e\u2502   0x00000872      e859fdffff     call sym.imp.puts\n\u2502     \u2502\u254e\u2502   0x00000877      b8ffffffff     mov eax, 0xffffffff         ; -1\n\u2502    \u250c\u2500\u2500\u2500\u2500< 0x0000087c      eb21           jmp 0x89f\n\u2502    \u2502\u2502\u254e\u2502   ; CODE XREF from main @ 0x869\n\u2502    \u2502\u2514\u2500\u2500\u2500> 0x0000087e      8385ecedffff.  add dword [var_1214h], 1\n\u2502    \u2502 \u254e\u2502   ; CODE XREF from main @ 0x83c\n\u2502    \u2502 \u254e\u2514\u2500> 0x00000885      83bdecedffff.  cmp dword [var_1214h], 0x22\n\u2502    \u2502 \u2514\u2500\u2500< 0x0000088c      7eb0           jle 0x83e\n\u2502    \u2502      0x0000088e      488d3d1b0100.  lea rdi, str.Congrats__The_password_is_the_flag. ; 0x9b0 ; "Congrats! The password is the flag."\n\u2502    \u2502      0x00000895      e836fdffff     call sym.imp.puts\n')),(0,a.kt)("p",null,"At each loop from ",(0,a.kt)("strong",{parentName:"p"},"0x0000088c")," to ",(0,a.kt)("strong",{parentName:"p"},"0x0000083e")," we need to take the jump at ",(0,a.kt)("strong",{parentName:"p"},"0x00000869")),(0,a.kt)("p",null,"The current character tested is subtracted by 1 at ",(0,a.kt)("strong",{parentName:"p"},"0x00000864")),(0,a.kt)("p",null,"With radare 2, here are the strings compared with the type pwd :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\u2502           0x00000779      4889d7         mov rdi, rdx\n\u2502           0x0000077c      f348ab         rep stosq qword [rdi], rax\n\u2502           0x0000077f      48b86a647567.  movabs rax, 0x7375747c6775646a ; 'jdug|tus'\n\u2502           0x00000789      48ba326f6874.  movabs rdx, 0x3473356074686f32 ; '2oht`5s4'\n\u2502           0x00000793      488985f0eeff.  mov qword [var_1110h], rax\n\u2502           0x0000079a      488995f8eeff.  mov qword [var_1108h], rdx\n\u2502           0x000007a1      48b86f756069.  movabs rax, 0x346565326960756f ; 'ou`i2ee4'\n\u2502           0x000007ab      48ba6f603238.  movabs rdx, 0x623233633832606f ; 'o`28c32b'\n\u2502           0x000007b5      48898500efff.  mov qword [var_1100h], rax\n\u2502           0x000007bc      48899508efff.  mov qword [var_10f8h], rdx\n\u2502           0x000007c3      48c78510efff.  mov qword [var_10f0h], 0x7e3a37 ; '7:~'\n\u2502           0x000007ce      48c78518efff.  mov qword [var_10e8h], 0\n\u2502           0x000007d9      488d9520efff.  lea rdx, [var_10e0h]\n")),(0,a.kt)("p",null,"A simple python script to solve the flag :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},"flag = 'jdug|tus2oht`5s4ou`i2ee4o`28c32b7:~'\n''.join([ chr(ord(elt)-1) for elt in flag ])\n")),(0,a.kt)("p",null,"it gives us :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ictf{str1ngs_4r3nt_h1dd3n_17b21a69}\n")),(0,a.kt)("p",null,"flag : ",(0,a.kt)("inlineCode",{parentName:"p"},"ictf{str1ngs_4r3nt_h1dd3n_17b21a69}")))}p.isMDXComponent=!0}}]);